07-Nov-2021 09:19:22.226 INFO [localhost-startStop-1] org.apache.catalina.core.ApplicationContext.log 1 Spring WebApplicationInitializers detected on classpath
07-Nov-2021 09:19:24.297 SEVERE [localhost-startStop-2] org.apache.catalina.core.StandardContext.listenerStart Exception sending context initialized event to listener instance of class [org.artifactory.lifecycle.webapp.servlet.ArtifactoryHomeConfigListener]
	java.lang.IllegalStateException: Could not find database table: db_properties
		at org.artifactory.converter.VersionProviderImpl.init(VersionProviderImpl.java:109)
		at org.artifactory.lifecycle.webapp.servlet.BasicConfigurationManager.initVersion(BasicConfigurationManager.java:160)
		at org.artifactory.lifecycle.webapp.servlet.BasicConfigurationManager.initArtifactoryInstallation(BasicConfigurationManager.java:139)
		at org.artifactory.lifecycle.webapp.servlet.BasicConfigurationManager.initialize(BasicConfigurationManager.java:126)
		at org.artifactory.lifecycle.webapp.servlet.ArtifactoryHomeConfigListener.initBasicConfigManager(ArtifactoryHomeConfigListener.java:61)
		at org.artifactory.lifecycle.webapp.servlet.ArtifactoryHomeConfigListener.contextInitialized(ArtifactoryHomeConfigListener.java:53)
		at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4763)
		at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5232)
		at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183)
		at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:755)
		at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:729)
		at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:695)
		at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:673)
		at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1881)
		at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
		at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
		at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
		at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
		at java.base/java.lang.Thread.run(Thread.java:829)
	Caused by: java.lang.IllegalStateException: Could not find database table: db_properties
		at org.artifactory.common.config.db.DbVersionDao.isDbPropertiesTableExists(DbVersionDao.java:65)
		at org.artifactory.converter.VersionProviderImpl.tryToResolveFromDb(VersionProviderImpl.java:197)
		at org.artifactory.converter.VersionProviderImpl.getCompoundVersionDetailsFromDbIfExists(VersionProviderImpl.java:122)
		at org.artifactory.converter.VersionProviderImpl.loadOriginalDbVersion(VersionProviderImpl.java:143)
		at org.artifactory.converter.VersionProviderImpl.init(VersionProviderImpl.java:104)
		... 18 more
	Caused by: java.sql.SQLException: Failed to create database '/opt/jfrog/artifactory/var/data/artifactory/derby', see the next exception for details.
		at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
		at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
		at org.apache.derby.impl.jdbc.Util.seeNextException(Unknown Source)
		at org.apache.derby.impl.jdbc.EmbedConnection.createDatabase(Unknown Source)
		at org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)
		at org.apache.derby.jdbc.InternalDriver$1.run(Unknown Source)
		at org.apache.derby.jdbc.InternalDriver$1.run(Unknown Source)
		at java.base/java.security.AccessController.doPrivileged(Native Method)
		at org.apache.derby.jdbc.InternalDriver.getNewEmbedConnection(Unknown Source)
		at org.apache.derby.jdbc.InternalDriver$LoginCallable.call(Unknown Source)
		at org.apache.derby.jdbc.InternalDriver$LoginCallable.call(Unknown Source)
		... 4 more
	Caused by: ERROR XJ041: Failed to create database '/opt/jfrog/artifactory/var/data/artifactory/derby', see the next exception for details.
		at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
		at org.apache.derby.impl.jdbc.SQLExceptionFactory.wrapArgsForTransportAcrossDRDA(Unknown Source)
		... 15 more
	Caused by: ERROR XBM0A: The database directory '/var/opt/jfrog/artifactory/data/artifactory/derby' exists. However, it does not contain the expected 'service.properties' file. Perhaps Derby was brought down in the middle of creating this database. You may want to delete this directory and try creating the database again.
		at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
		at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
		at org.apache.derby.impl.services.monitor.StorageFactoryService.vetService(Unknown Source)
		at org.apache.derby.impl.services.monitor.StorageFactoryService.access$900(Unknown Source)
		at org.apache.derby.impl.services.monitor.StorageFactoryService$10.run(Unknown Source)
		at java.base/java.security.AccessController.doPrivileged(Native Method)
		at org.apache.derby.impl.services.monitor.StorageFactoryService.createServiceRoot(Unknown Source)
		at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(Unknown Source)
		at org.apache.derby.impl.services.monitor.BaseMonitor.createPersistentService(Unknown Source)
		at org.apache.derby.impl.services.monitor.FileMonitor.createPersistentService(Unknown Source)
		at org.apache.derby.iapi.services.monitor.Monitor.createPersistentService(Unknown Source)
		at org.apache.derby.impl.jdbc.EmbedConnection$5.run(Unknown Source)
		at java.base/java.security.AccessController.doPrivileged(Native Method)
		at org.apache.derby.impl.jdbc.EmbedConnection.createPersistentService(Unknown Source)
		... 12 more
07-Nov-2021 09:19:24.298 SEVERE [localhost-startStop-2] org.apache.catalina.core.StandardContext.listenerStart Exception sending context initialized event to listener instance of class [org.artifactory.lifecycle.webapp.servlet.ArtifactoryContextConfigListener]
	java.lang.IllegalStateException: Artifactory home not initialized.
		at org.artifactory.lifecycle.webapp.servlet.ArtifactoryContextConfigListener.getArtifactoryHome(ArtifactoryContextConfigListener.java:203)
		at org.artifactory.lifecycle.webapp.servlet.ArtifactoryContextConfigListener.setSessionTrackingMode(ArtifactoryContextConfigListener.java:184)
		at org.artifactory.lifecycle.webapp.servlet.ArtifactoryContextConfigListener.init(ArtifactoryContextConfigListener.java:101)
		at org.artifactory.lifecycle.webapp.servlet.ArtifactoryContextConfigListener.contextInitialized(ArtifactoryContextConfigListener.java:89)
		at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4763)
		at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5232)
		at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183)
		at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:755)
		at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:729)
		at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:695)
		at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:673)
		at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1881)
		at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
		at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
		at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
		at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
		at java.base/java.lang.Thread.run(Thread.java:829)
07-Nov-2021 09:19:26.141 INFO [localhost-startStop-1] org.apache.catalina.core.ApplicationContext.log Initializing Spring embedded WebApplicationContext
